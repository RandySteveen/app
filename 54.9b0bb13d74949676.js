"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[54],{54:(M,b,d)=>{d.r(b),d.d(b,{NewordersclientPageModule:()=>Q});var f=d(6814),l=d(95),c=d(9843),h=d(4193),p=d(5861),Z=d(553),T=d(2726),e=d(5879),N=d(9862),w=d(1229),U=d(2014);function A(i,s){if(1&i&&(e.TgZ(0,"ion-select-option",34),e._uU(1),e.qZA()),2&i){const r=s.$implicit;e.Q6J("value",r.cod_departamento),e.xp6(1),e.hij(" ",r.des_departamento," ")}}function C(i,s){if(1&i&&(e.TgZ(0,"ion-select-option",34),e._uU(1),e.qZA()),2&i){const r=s.$implicit;e.Q6J("value",r.cod_grupo),e.xp6(1),e.hij(" ",r.des_grupo," ")}}function D(i,s){if(1&i&&(e.TgZ(0,"ion-select-option",34),e._uU(1),e.qZA()),2&i){const r=s.$implicit;e.Q6J("value",r.cod_subgru),e.xp6(1),e.hij(" ",r.des_subgru," ")}}function S(i,s){if(1&i&&(e.TgZ(0,"ion-select-option",34),e._uU(1),e.qZA()),2&i){const r=s.$implicit;e.Q6J("value",r.cod_marca),e.xp6(1),e.hij(" ",r.des_marca," ")}}function x(i,s){if(1&i&&(e.TgZ(0,"div",39),e._uU(1),e.qZA()),2&i){const r=e.oxw().$implicit;e.xp6(1),e.hij(" El producto ",r.codart," ya ha sido seleccionado. ")}}function q(i,s){if(1&i){const r=e.EpF();e.TgZ(0,"ion-row")(1,"ion-col",28),e._uU(2),e.qZA(),e.TgZ(3,"ion-col",29),e._uU(4),e.qZA(),e.TgZ(5,"ion-col",30),e._uU(6),e.qZA(),e.TgZ(7,"ion-col",29),e._uU(8),e.qZA(),e.TgZ(9,"ion-col",29)(10,"ion-input",35),e.NdJ("keypress",function(o){e.CHM(r);const n=e.oxw();return e.KtG(n.validateNumber(o))})("input",function(o){const a=e.CHM(r).$implicit,u=e.oxw();return e.KtG(u.updateCantidad(a,o))}),e.qZA()(),e.TgZ(11,"ion-col",29),e._uU(12),e.qZA(),e.TgZ(13,"ion-col",29),e._uU(14),e.qZA(),e.TgZ(15,"ion-col",29)(16,"a",36),e.NdJ("click",function(){const n=e.CHM(r).$implicit,a=e.oxw();return e.KtG(a.toggleSelection(n))}),e._UZ(17,"ion-icon",37),e.qZA()(),e.YNc(18,x,2,1,"div",38),e.qZA()}if(2&i){const r=s.$implicit,t=s.index,o=e.oxw();e.xp6(2),e.Oqu((o.currentPage-1)*o.itemsPerPage+t+1),e.xp6(2),e.hij(" ",r.codart," "),e.xp6(2),e.hij(" ",r.desart," "),e.xp6(2),e.hij(" ",r.exialm," "),e.xp6(4),e.hij(" ",r.preve1," "),e.xp6(2),e.hij(" ",r.preve3," "),e.xp6(3),e.Udp("color",r.seleccionado?"red":"green"),e.xp6(1),e.Q6J("ngIf",r.showProductSelectedMessage)}}function I(i,s){if(1&i&&(e.TgZ(0,"ion-select-option",34),e._uU(1),e.qZA()),2&i){const r=s.$implicit;e.Q6J("value",r),e.xp6(1),e.hij(" ",r," ")}}const{Geolocation:J}=T.Plugins,y=[{path:"",component:(()=>{var i;class s{constructor(t,o,n,a,u,g){this.http=t,this.router=o,this.route=n,this.fb=a,this.dataSharingService=u,this.storage=g,this.searchText="",this.items=[],this.currentPage=1,this.itemsPerPageOptions=[5,10,20],this.itemsPerPage=10,this.displayedItems=[],this.totalPages=1,this.contador=0,this.ionSelectsEnabled=!0,this.showProductSelectedMessage=!1,this.selectedProducts=new Set,this.dataLoaded=!1,this.infopres=[],this.infomar=[],this.infocar=[],this.infosub=[],this.infogrup=[],this.infoDep=[],this.infoCli=[],this.FormData=this.fb.group({departamento:new l.NI(""),grupo:new l.NI(""),subgrupo:new l.NI(""),categoria:new l.NI(""),marca:new l.NI(""),presentacion:new l.NI(""),nomcli:new l.NI(""),codcli:new l.NI(""),dirsed:new l.NI(""),dessed:new l.NI(""),latitu:new l.NI(""),longit:new l.NI("")}),this.initStorage()}getLocation(){var t=this;return(0,p.Z)(function*(){try{var o,n;const a=yield J.getCurrentPosition(),u=a.coords.latitude,g=a.coords.longitude;null===(o=t.FormData.get("latitu"))||void 0===o||o.setValue(u),null===(n=t.FormData.get("longit"))||void 0===n||n.setValue(g),t.storage.set("cachedLocation",{latitude:u,longitude:g})}catch{}})()}validateNumber(t){const o=String.fromCharCode(t.which);/[0-9]/.test(o)||t.preventDefault()}get depa(){return this.FormData.get("departamento")}get gru(){return this.FormData.get("grupo")}get subgru(){return this.FormData.get("subgrupo")}get categ(){return this.FormData.get("categoria")}get marca(){return this.FormData.get("marca")}get present(){return this.FormData.get("presentacion")}getData(){var t=this;return(0,p.Z)(function*(){t.selectedProducts=new Set,t.http.post(`${Z.N.APIURL}/found/filter`,t.FormData.value).subscribe(o=>{t.items=o.info,t.loadDisplayedItems();const n=t.items.filter(_=>_.seleccionado),g=[...t.dataSharingService.getDatosSeleccionados(),...n],m=[...t.selectedProducts];t.dataSharingService.enviarDatosSeleccionados(m),t.storage.set("filter_order_data",g)})})()}ViewData2(){var t=this;return(0,p.Z)(function*(){t.idsuc=t.route.snapshot.paramMap.get("idsuc"),t.http.get(`${Z.N.apiOrdersUrl}/new/client/${t.idsuc}`).subscribe(o=>{var n,a,u,g,m,_,P,v;t.info=o.infoCli,t.info&&t.info.length>0&&(t.FormData.patchValue({nomcli:null===(n=t.info[0])||void 0===n?void 0:n.nomcli,codcli:null===(a=t.info[0])||void 0===a?void 0:a.codcli,dirsed:null===(u=t.info[0])||void 0===u?void 0:u.dirsed,dessed:null===(g=t.info[0])||void 0===g?void 0:g.dessed}),null===(m=t.FormData.get("nomcli"))||void 0===m||m.disable(),null===(_=t.FormData.get("codcli"))||void 0===_||_.disable(),null===(P=t.FormData.get("dirsed"))||void 0===P||P.disable(),null===(v=t.FormData.get("dessed"))||void 0===v||v.disable(),t.storage.set(`cliorder_data_${t.idsuc}`,t.info))})})()}initStorage(){var t=this;return(0,p.Z)(function*(){yield t.storage.create()})()}viewData(){var t=this;return(0,p.Z)(function*(){t.http.get(`${Z.N.APIURL}/filter`).subscribe(o=>{t.infoDep=o.infoDep,t.infogrup=o.infogrup,t.infosub=o.infosub,t.infocar=o.infocar,t.infomar=o.infomar,t.infopres=o.infopres,console.log(o),t.storage.set("info_form_order_data",o)})})()}clearSelections(){var t,o,n,a;this.ionSelectsEnabled=!0,null===(t=this.FormData.get("departamento"))||void 0===t||t.setValue(null),null===(o=this.FormData.get("grupo"))||void 0===o||o.setValue(null),null===(n=this.FormData.get("subgrupo"))||void 0===n||n.setValue(null),null===(a=this.FormData.get("marca"))||void 0===a||a.setValue(null)}ngOnInit(){var t=this;return(0,p.Z)(function*(){t.ionSelectsEnabled=!1,t.getLocation(),t.dataSharingService.getDatosSeleccionados().forEach(n=>{t.selectedProducts.add(n)}),t.contador=t.selectedProducts.size,t.dataLoaded||(t.ViewData2(),t.viewData(),t.dataLoaded=!0)})()}listorder(){var t=this;return(0,p.Z)(function*(){const o=[...t.selectedProducts];console.log(o),t.dataSharingService.enviarDatosSeleccionados(o),t.router.navigate(["listorders",t.idsuc]),t.dataSharingService.setContador(t.contador)})()}goToPage(t){t>=1&&t<=this.totalPages&&(this.currentPage=t,this.loadDisplayedItems(),localStorage.setItem("storedClients",JSON.stringify(this.items)))}loadDisplayedItems(){const t=(this.currentPage-1)*this.itemsPerPage;this.displayedItems=this.filteredItems.slice(t,t+this.itemsPerPage),this.totalPages=Math.ceil(this.filteredItems.length/this.itemsPerPage)}sortColumn(t){this.filteredItems.sort((o,n)=>o[t]<n[t]?-1:o[t]>n[t]?1:0),this.loadDisplayedItems()}toggleSelection(t){var o=this;return(0,p.Z)(function*(){if(o.selectedProducts.has(t)){const n=[...o.selectedProducts].find(a=>a.codart===t.codart);n&&(n.Cantidad=t.Cantidad,0===t.Cantidad&&(o.selectedProducts.delete(n),t.seleccionado=!1,o.contador-=1))}else t.seleccionado=!0,t.Cantidad=1,o.selectedProducts.add(t),o.contador+=1})()}onPageChange(t){this.itemsPerPage=t.detail.value,this.totalPages=Math.ceil(this.filteredItems.length/this.itemsPerPage),this.currentPage=1,this.loadDisplayedItems(),localStorage.setItem("storedClients",JSON.stringify(this.items))}get filteredItems(){return this.items.filter(t=>t.desart.toLowerCase().includes(this.searchText.toLowerCase())||t.codart.toLowerCase().includes(this.searchText.toLowerCase()))}updateCantidad(t,o){t.Cantidad=o.target.value}onSearchInput(t){const o=t.target;null!=o.value&&(this.searchText=o.value,this.loadDisplayedItems())}}return(i=s).\u0275fac=function(t){return new(t||i)(e.Y36(N.eN),e.Y36(h.F0),e.Y36(h.gz),e.Y36(l.qu),e.Y36(w.s),e.Y36(U.K))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-newordersclient"]],decls:127,vars:18,consts:[[3,"translucent"],["scroll-y","true",3,"fullscreen"],["align","center"],[3,"formGroup"],["position","floating"],["name","newspaper-outline"],["formControlName","codcli"],["name","document-text-outline"],["formControlName","nomcli"],["name","airplane-outline"],["formControlName","dirsed"],["name","storefront-outline"],["formControlName","dessed"],["color","success",2,"width","25%","margin-left","20px",3,"click"],["name","search-outline"],["color","danger",2,"float","right","width","25%","margin-right","20px",3,"click"],["name","trash-outline"],["formControlName","departamento",3,"disabled"],[3,"value",4,"ngFor","ngForOf"],["name","people-outline"],["formControlName","grupo",3,"disabled"],["name","pie-chart-outline"],["formControlName","subgrupo",3,"disabled"],["name","nuclear-outline"],["formControlName","marca",3,"disabled"],["color","primary",2,"background","transparent","width","10%","height","6%","float","right","margin-right","20px","margin-top","44px",3,"click"],["name","cart-outline",2,"font-size","40px"],["placeholder","Buscar...",1,"custom-search-input",3,"ngModel","ngModelChange","input"],["size","1"],["size","1.5"],["size","2"],[4,"ngFor","ngForOf"],[3,"value","ionChange"],[3,"disabled","click"],[3,"value"],["placeholder","Cantidad","color","success",3,"keypress","input"],[3,"click"],["name","cart-outline",2,"font-size","25px"],["class","product-selected-message",4,"ngIf"],[1,"product-selected-message"]],template:function(t,o){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"newordersclient"),e.qZA()()(),e.TgZ(4,"ion-content",1),e._UZ(5,"br"),e.TgZ(6,"ion-title",2),e._uU(7,"Nuevo Pedido"),e.qZA(),e._UZ(8,"br")(9,"br"),e.TgZ(10,"ion-title",2),e._uU(11,"Agregar Nuevo Pedido"),e.qZA(),e._UZ(12,"br")(13,"br"),e.TgZ(14,"form",3)(15,"ion-item")(16,"ion-label",4),e._UZ(17,"ion-icon",5),e._uU(18,".RIF"),e.qZA(),e._UZ(19,"ion-input",6),e.qZA(),e._UZ(20,"br"),e.TgZ(21,"ion-item")(22,"ion-label",4),e._UZ(23,"ion-icon",7),e._uU(24,".Razon Social"),e.qZA(),e._UZ(25,"ion-input",8),e.qZA(),e._UZ(26,"br"),e.TgZ(27,"ion-item")(28,"ion-label",4),e._UZ(29,"ion-icon",9),e._uU(30,".Direccion de Despacho"),e.qZA(),e._UZ(31,"ion-input",10),e.qZA(),e._UZ(32,"br"),e.TgZ(33,"ion-item")(34,"ion-label",4),e._UZ(35,"ion-icon",11),e._uU(36,".Descripcion de Sucursal"),e.qZA(),e._UZ(37,"ion-input",12),e.qZA(),e._UZ(38,"br")(39,"br"),e.TgZ(40,"ion-title",2),e._uU(41,"Seleccione sus Productos"),e.qZA(),e._UZ(42,"br"),e.TgZ(43,"ion-button",13),e.NdJ("click",function(){return o.getData()}),e._UZ(44,"ion-icon",14),e._uU(45,".Buscar"),e.qZA(),e.TgZ(46,"ion-button",15),e.NdJ("click",function(){return o.clearSelections()}),e._UZ(47,"ion-icon",16),e._uU(48,".Limpiar"),e.qZA(),e._UZ(49,"br")(50,"br"),e.TgZ(51,"ion-item")(52,"ion-label",4),e._uU(53,".Departamento"),e.qZA(),e.TgZ(54,"ion-select",17),e.YNc(55,A,2,2,"ion-select-option",18),e.qZA()(),e._UZ(56,"br"),e.TgZ(57,"ion-item")(58,"ion-label",4),e._UZ(59,"ion-icon",19),e._uU(60,".Grupo"),e.qZA(),e.TgZ(61,"ion-select",20),e.YNc(62,C,2,2,"ion-select-option",18),e.qZA()(),e._UZ(63,"br"),e.TgZ(64,"ion-item")(65,"ion-label",4),e._UZ(66,"ion-icon",21),e._uU(67,".Sub-Grupo"),e.qZA(),e.TgZ(68,"ion-select",22),e.YNc(69,D,2,2,"ion-select-option",18),e.qZA()(),e._UZ(70,"br"),e.TgZ(71,"ion-item")(72,"ion-label",4),e._UZ(73,"ion-icon",23),e._uU(74,".Marca"),e.qZA(),e.TgZ(75,"ion-select",24),e.YNc(76,S,2,2,"ion-select-option",18),e.qZA()(),e._UZ(77,"br")(78,"br"),e.qZA(),e.TgZ(79,"ion-button",25),e.NdJ("click",function(){return o.listorder()}),e._UZ(80,"ion-icon",26),e._uU(81),e.qZA(),e._UZ(82,"br")(83,"br")(84,"hr")(85,"hr"),e.TgZ(86,"ion-item")(87,"ion-label",4),e._UZ(88,"ion-icon",14),e._uU(89,".Buscar"),e.qZA(),e.TgZ(90,"ion-input",27),e.NdJ("ngModelChange",function(a){return o.searchText=a})("input",function(a){return o.onSearchInput(a)}),e.qZA()(),e._UZ(91,"br")(92,"br"),e.TgZ(93,"ion-grid")(94,"ion-row")(95,"ion-col",28)(96,"strong"),e._uU(97,"No"),e.qZA()(),e.TgZ(98,"ion-col",29)(99,"strong"),e._uU(100,"Codigo"),e.qZA()(),e.TgZ(101,"ion-col",30)(102,"strong"),e._uU(103,"Producto"),e.qZA()(),e.TgZ(104,"ion-col",29)(105,"strong"),e._uU(106,"Existencia"),e.qZA()(),e.TgZ(107,"ion-col",29)(108,"strong"),e._uU(109,"Cantidad"),e.qZA()(),e.TgZ(110,"ion-col",29)(111,"strong"),e._uU(112,"Precio(1)"),e.qZA()(),e.TgZ(113,"ion-col",29)(114,"strong"),e._uU(115,"Precio(2)"),e.qZA()(),e.TgZ(116,"ion-col",29)(117,"strong"),e._uU(118,"ADD"),e.qZA()()(),e.YNc(119,q,19,9,"ion-row",31),e.qZA(),e.TgZ(120,"ion-select",32),e.NdJ("ionChange",function(a){return o.onPageChange(a)}),e.YNc(121,I,2,2,"ion-select-option",18),e.qZA(),e.TgZ(122,"ion-buttons")(123,"ion-button",33),e.NdJ("click",function(){return o.goToPage(o.currentPage-1)}),e._uU(124,"Anterior"),e.qZA(),e.TgZ(125,"ion-button",33),e.NdJ("click",function(){return o.goToPage(o.currentPage+1)}),e._uU(126,"Siguiente"),e.qZA()()()),2&t&&(e.Q6J("translucent",!0),e.xp6(4),e.Q6J("fullscreen",!0),e.xp6(10),e.Q6J("formGroup",o.FormData),e.xp6(40),e.Q6J("disabled",!o.ionSelectsEnabled),e.xp6(1),e.Q6J("ngForOf",o.infoDep),e.xp6(6),e.Q6J("disabled",!o.ionSelectsEnabled),e.xp6(1),e.Q6J("ngForOf",o.infogrup),e.xp6(6),e.Q6J("disabled",!o.ionSelectsEnabled),e.xp6(1),e.Q6J("ngForOf",o.infosub),e.xp6(6),e.Q6J("disabled",!o.ionSelectsEnabled),e.xp6(1),e.Q6J("ngForOf",o.infomar),e.xp6(5),e.hij(" ",o.contador," "),e.xp6(9),e.Q6J("ngModel",o.searchText),e.xp6(29),e.Q6J("ngForOf",o.displayedItems),e.xp6(1),e.Q6J("value",o.itemsPerPage),e.xp6(1),e.Q6J("ngForOf",o.itemsPerPageOptions),e.xp6(2),e.Q6J("disabled",1===o.currentPage),e.xp6(2),e.Q6J("disabled",o.currentPage===o.totalPages))},dependencies:[f.sg,f.O5,l._Y,l.JJ,l.JL,l.On,c.YG,c.Sm,c.wI,c.W2,c.jY,c.Gu,c.gu,c.pK,c.Ie,c.Q$,c.Nd,c.t9,c.n0,c.wd,c.sr,c.QI,c.j9,l.sg,l.u],styles:['@charset "UTF-8";.custom-search-input[_ngcontent-%COMP%]{border:none;border-bottom:1px solid #000;border-radius:0;padding:.5rem;background-color:transparent;width:100%;font-size:1rem;color:#fff;outline:none}.custom-search-input[_ngcontent-%COMP%]:focus{border-bottom:2px solid #007bff}.product-selected-message[_ngcontent-%COMP%]{background-color:#f44336;color:#fff;padding:10px;text-align:center;display:block}']}),s})()}];let F=(()=>{var i;class s{}return(i=s).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[h.Bz.forChild(y),h.Bz]}),s})(),Q=(()=>{var i;class s{}return(i=s).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[f.ez,l.u5,c.Pc,F,l.UX]}),s})()}}]);
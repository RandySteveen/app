"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9260],{9260:(k,P,u)=>{u.r(P),u.d(P,{PagoinvoiceoldPageModule:()=>Y});var h=u(6814),g=u(95),l=u(9843),v=u(4193),m=u(5861),f=u(553),T=u(6726),e=u(5879),U=u(6593),A=u(9862),b=u(7076);function I(i,s){if(1&i&&(e.TgZ(0,"ion-col",15),e._uU(1),e.ALo(2,"date"),e.qZA()),2&i){const c=e.oxw().$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,c.fecent,"dd/MM/yyyy"))}}function C(i,s){if(1&i&&(e.TgZ(0,"ion-col",15),e._uU(1),e.qZA()),2&i){const c=e.oxw().$implicit;e.xp6(1),e.hij("",c.diferenciaFechas," d\xedas ")}}function y(i,s){1&i&&e._UZ(0,"ion-checkbox",37)}function q(i,s){if(1&i&&(e.TgZ(0,"ion-row"),e._UZ(1,"ion-col",15),e.TgZ(2,"ion-col",15),e._uU(3),e.qZA(),e.TgZ(4,"ion-col",15),e._uU(5),e.qZA(),e.YNc(6,I,3,4,"ion-col",33),e.TgZ(7,"ion-col",15),e._uU(8),e.ALo(9,"date"),e.qZA(),e.YNc(10,C,2,1,"ion-col",33),e.TgZ(11,"ion-col",15),e._uU(12),e.qZA(),e.TgZ(13,"ion-col",15),e._uU(14),e.qZA(),e.TgZ(15,"ion-col",15),e._uU(16),e.qZA(),e._UZ(17,"ion-col",34),e.TgZ(18,"ion-col",35),e._UZ(19,"ion-checkbox"),e.YNc(20,y,1,0,"ion-checkbox",36),e.qZA()()),2&i){const c=s.$implicit,o=s.index,n=e.oxw();e.xp6(3),e.hij(" ",(n.currentPage-1)*n.itemsPerPage+o+1," "),e.xp6(2),e.AsE(" ",c.codfmv,"--",c.codmov,""),e.xp6(1),e.Q6J("ngIf","FC"===c.estfac),e.xp6(2),e.Oqu(e.xi3(9,10,c.fecven,"dd/MM/yyyy")),e.xp6(2),e.Q6J("ngIf","FC"===c.estfac),e.xp6(2),e.hij("",c.numcarg," "),e.xp6(2),e.Oqu(n.getEstadoFacturaText(c.estfac)),e.xp6(2),e.Oqu(c.saldou),e.xp6(4),e.Q6J("ngIf","01"===n.codmfv)}}function x(i,s){if(1&i){const c=e.EpF();e.TgZ(0,"div",38)(1,"ion-datetime",39),e.NdJ("ngModelChange",function(n){e.CHM(c);const t=e.oxw();return e.KtG(t.selectedDate=n)})("ionChange",function(n){e.CHM(c);const t=e.oxw();return e.KtG(t.onDateChange(n))}),e.qZA()()}if(2&i){const c=e.oxw();e.xp6(1),e.Q6J("ngModel",c.selectedDate)}}function M(i,s){1&i&&(e.TgZ(0,"ion-col",17)(1,"ion-item")(2,"ion-label",6),e._uU(3,".Tipo de Bancos"),e.qZA(),e.TgZ(4,"ion-select")(5,"ion-select-option"),e._uU(6,"Venezuela"),e.qZA(),e.TgZ(7,"ion-select-option"),e._uU(8,"Provincial"),e.qZA(),e.TgZ(9,"ion-select-option"),e._uU(10,"Mercantil"),e.qZA(),e.TgZ(11,"ion-select-option"),e._uU(12,"Sofitasa"),e.qZA(),e.TgZ(13,"ion-select-option"),e._uU(14,"Banca Amiga"),e.qZA(),e.TgZ(15,"ion-select-option"),e._uU(16,"BNC"),e.qZA()()()())}function F(i,s){1&i&&(e.TgZ(0,"ion-col",17)(1,"ion-item")(2,"ion-label",6),e._uU(3,"Tasa"),e.qZA(),e._UZ(4,"ion-input",40),e.qZA()())}function w(i,s){1&i&&(e.TgZ(0,"div",41)(1,"ion-title",42),e._uU(2,"Por favor sube tu Recibo de Pago"),e.qZA()())}function J(i,s){if(1&i&&(e.TgZ(0,"div"),e._UZ(1,"img",43),e.qZA()),2&i){const c=s.$implicit;e.xp6(1),e.Q6J("src",c,e.LSH)}}function D(i,s){if(1&i&&(e.TgZ(0,"ion-select-option",44),e._uU(1),e.qZA()),2&i){const c=s.$implicit;e.Q6J("value",c),e.xp6(1),e.hij(" ",c," ")}}const N=[{path:"",component:(()=>{var i;class s{onMetodoPagoChange(o){this.metodoPago=o.detail.value}onRadioSelect(o){o.seleccionado=!o.seleccionado,console.log("Radio seleccionado:",o)}updateMonto(o,n,t){var a;this.montos[o]=n,t.monpag=n,this.montosConValor.includes(o)||this.montosConValor.push(o);const r=this.montosConValor.map(d=>this.items[d]);null===(a=this.FormInvoice.get("facturas"))||void 0===a||a.patchValue(r),this.calcularTotal()}openGallery(){var o=this;return(0,m.Z)(function*(){try{const n=yield navigator.mediaDevices.getUserMedia({video:!0});if(n){const t=document.createElement("video");t.srcObject=n,t.play(),t.addEventListener("loadedmetadata",(0,m.Z)(function*(){var a;const r=document.createElement("canvas");r.width=t.videoWidth,r.height=t.videoHeight,null===(a=r.getContext("2d"))||void 0===a||a.drawImage(t,0,0);const d=r.toDataURL("image/jpeg");o.showCapturedImage(d),n.getTracks().forEach(p=>p.stop())}))}}catch(n){console.error("Error al acceder a la c\xe1mara:",n)}})()}showCapturedImage(o){var n;document.createElement("img").src=o,null===(n=this.FormInvoice.get("imgpag"))||void 0===n||n.setValue(o),this.capturedImages.push(o)}openGallery1(){var o=this;return(0,m.Z)(function*(){const n=document.createElement("input");n.type="file",n.accept="image/*",n.multiple=!0,n.addEventListener("change",function(){var t=(0,m.Z)(function*(a){const r=a.target.files;if(r&&r.length>0)for(let p=0;p<r.length;p++){const _=r[p];if(_.type.startsWith("image/")){var d;const Z=URL.createObjectURL(_);null===(d=o.FormInvoice.get("imgdiv"))||void 0===d||d.setValue(Z),o.selectedImages1.push(Z)}else console.error("El archivo seleccionado no es una imagen.")}});return function(a){return t.apply(this,arguments)}}()),n.click()})()}toggleCalendar(){this.selectedDate=this.currentDate,this.showCalendar=!this.showCalendar}routerdevueld(){this.codcli=this.router.snapshot.paramMap.get("codcli"),this.route.navigate(["invoice-data",this.codcli])}constructor(o,n,t,a,r,d,p){this.route=o,this.domSanitizer=n,this.router=t,this.http=a,this.fb=r,this.loginService=d,this.alertController=p,this.elementoSeleccionado=-1,this.opcionesSeleccionadas=[],this.metodoPago="",this.searchText="",this.items=[],this.currentPage=1,this.itemsPerPageOptions=[5,10,20],this.itemsPerPage=10,this.displayedItems=[],this.totalPages=1,this.selectedDate="",this.showCalendar=!1,this.selectedImages=[],this.capturedImages=[],this.selectedImages1=[],this.monto=0,this.montos=[],this.currentDate="",this.selectedDate1="",this.montosConValor=[],this.FormInvoice=this.fb.group({nomcli:new g.NI(""),codcli:new g.NI(""),imgpag:new g.NI(""),imgdiv:new g.NI(""),TotPag:new g.NI(""),codmfv:new g.NI(""),codmov:new g.NI(""),codrec:new g.NI(""),facturas:[{}],fecAct:new g.NI("")}),this.itemsPerPage=this.itemsPerPageOptions[0],this.currentDate=(0,h.p6)(new Date,"dd/MM/yyyy","en-US"),this.selectedDate1=this.currentDate}onDateChange(o){this.selectedDate=o.detail.value}calcularTotal(){var o;const n=this.items.reduce((t,a)=>t+(a.monpag||0),0);return null===(o=this.FormInvoice.get("TotPag"))||void 0===o||o.setValue(n),n}ngOnInit(){var o;this.viewData(),this.viewDataTable(),null===(o=this.FormInvoice.get("fecAct"))||void 0===o||o.setValue(this.currentDate)}sendData(){var o=this;return(0,m.Z)(function*(){var t;yield(yield o.alertController.create({header:"Reportar Pago",message:"Estas seguro de Reportar el Pago!!",buttons:[{text:"Cancelar",role:"Cancel",cssClass:"secondary",handler:()=>{}},{text:"Aceptar",handler:(t=(0,m.Z)(function*(){const a=yield o.loginService.getLoginInfo(),{codved:r}=(0,T.Z)(a);o.http.post(`${f.N.apiInvoicesUrl}/save/payment`,r).subscribe(d=>{}),console.log(o.FormInvoice.value)}),function(){return t.apply(this,arguments)})}]})).present()})()}end(){this.codcli=this.router.snapshot.paramMap.get("codcli"),this.route.navigate(["invoice-data",this.codcli])}viewDataTable(){var o=this;return(0,m.Z)(function*(){o.codcli=yield o.router.snapshot.paramMap.get("codcli"),o.http.get(`${f.N.apiInvoicesUrl}/and/payment/${o.codcli}`).subscribe(n=>{o.codmov=n.info[0].codmov,o.items=n.info,console.log(n),o.codmfv=n.info[0].codfmv,o.items.forEach(t=>{var a,r,d;if(null===(a=o.FormInvoice.get("codmfv"))||void 0===a||a.patchValue(o.codmfv),null===(r=o.FormInvoice.get("codmov"))||void 0===r||r.patchValue(o.codmov),null===(d=o.FormInvoice.get("codrec"))||void 0===d||d.patchValue(o.codmov),"FC"===t.estfac){const _=(new Date).getTime()-new Date(t.fecent).getTime(),Z=Math.floor(_/864e5);t.diferenciaFechas=Z}}),o.loadDisplayedItems()})})()}getEstadoFacturaText(o){switch(o){case"FC":return"Cobranza";case"FE":return"Facturado";case"FV":return"Almacen";case"FT":return"Transito";case"FA":case"FR":return"Procesando";default:return"Desconocido"}}viewData(){var o=this;return(0,m.Z)(function*(){o.codcli=yield o.router.snapshot.paramMap.get("codcli"),o.http.get(`${f.N.apiInvoicesUrl}/and/payment/${o.codcli}`).subscribe(n=>{var t,a,r,d;o.info=n.client,o.info&&o.info.length>0&&(o.FormInvoice.patchValue({nomcli:null===(t=o.info[0])||void 0===t?void 0:t.nomcli,codcli:null===(a=o.info[0])||void 0===a?void 0:a.codcli}),null===(r=o.FormInvoice.get("nomcli"))||void 0===r||r.disable(),null===(d=o.FormInvoice.get("codcli"))||void 0===d||d.disable())})})()}onSearchInput(o){const n=o.target;null!=n.value&&(this.searchText=n.value,this.loadDisplayedItems())}get filteredItems(){return this.items.filter(o=>o.codmov.toLowerCase().includes(this.searchText.toLowerCase())||o.estfac.toLowerCase().includes(this.searchText.toLowerCase()))}loadDisplayedItems(){const o=(this.currentPage-1)*this.itemsPerPage;this.displayedItems=this.filteredItems.slice(o,o+this.itemsPerPage)}onPageChange(o){console.log(o),this.itemsPerPage=o.detail.value,this.totalPages=Math.ceil(this.filteredItems.length/this.itemsPerPage),this.currentPage=1,this.loadDisplayedItems()}goToPage(o){o>=1&&o<=this.totalPages&&(this.currentPage=o,this.loadDisplayedItems(),localStorage.setItem("storedClients",JSON.stringify(this.items)))}}return(i=s).\u0275fac=function(o){return new(o||i)(e.Y36(v.F0),e.Y36(U.H7),e.Y36(v.gz),e.Y36(A.eN),e.Y36(g.qu),e.Y36(b.F),e.Y36(l.Br))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-pagoinvoiceold"]],decls:140,vars:18,consts:[[3,"translucent"],["scroll-y","true",3,"fullscreen"],["align","center"],[2,"float","right","margin-right","30px",3,"click"],["name","arrow-forward-outline","color","danger",2,"font-size","3em"],[3,"formGroup"],["position","floating"],["name","newspaper-outline"],["formControlName","codcli"],["name","document-text-outline"],["formControlName","nomcli"],["name","wallet-outline"],[3,"ngModel","ngModelChange"],["name","search-outline"],["placeholder","Buscar...",1,"custom-search-input",3,"ngModel","ngModelChange","input"],["size","1","align","center"],[4,"ngFor","ngForOf"],["size","1"],["disabled","true",3,"value"],["fill","clear",3,"click"],["name","calendar"],["class","calendar-container",4,"ngIf"],[1,"current-date"],["size","1",4,"ngIf"],["type","number",3,"value"],["expand","block","color","primary",3,"click"],["name","image-outline"],["style","text-align: center;",4,"ngIf"],["color","success",2,"margin-left","20px",3,"ngModel","ngModelChange","ionChange"],["color","success",3,"value",4,"ngFor","ngForOf"],[3,"disabled","click"],["expand","block","color","success",3,"click"],["expand","block","color","danger",3,"click"],["size","1","align","center",4,"ngIf"],["size","0"],["size","1",2,"margin-left","40px"],["style","margin-left: 20px;",4,"ngIf"],[2,"margin-left","20px"],[1,"calendar-container"],["displayFormat","DD/MM/YYYY",1,"custom-calendar",3,"ngModel","ngModelChange","ionChange"],["type","number"],[2,"text-align","center"],["color","danger"],["alt","Imagen seleccionada",2,"max-width","50%","max-height","50%","display","block","margin","0 auto",3,"src"],["color","success",3,"value"]],template:function(o,n){1&o&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"Pago Facturacion"),e.qZA()()(),e.TgZ(4,"ion-content",1),e._UZ(5,"br"),e.TgZ(6,"ion-title",2),e._uU(7,"Pago Facturas"),e.qZA(),e.TgZ(8,"a",3),e.NdJ("click",function(){return n.routerdevueld()}),e._UZ(9,"ion-icon",4),e.qZA(),e._UZ(10,"br")(11,"br"),e.TgZ(12,"ion-title",2),e._uU(13,"Datos del Cliente"),e.qZA(),e._UZ(14,"br")(15,"br"),e.TgZ(16,"form",5)(17,"ion-item")(18,"ion-label",6),e._UZ(19,"ion-icon",7),e._uU(20,".RIF"),e.qZA(),e._UZ(21,"ion-input",8),e.qZA(),e._UZ(22,"br"),e.TgZ(23,"ion-item")(24,"ion-label",6),e._UZ(25,"ion-icon",9),e._uU(26,".Razon Social "),e.qZA(),e._UZ(27,"ion-input",10),e.qZA(),e._UZ(28,"br"),e.qZA(),e.TgZ(29,"ion-item")(30,"ion-label",6),e._UZ(31,"ion-icon",11),e._uU(32," M\xe9todo de Pago "),e.qZA(),e.TgZ(33,"ion-select",12),e.NdJ("ngModelChange",function(a){return n.metodoPago=a}),e.TgZ(34,"ion-select-option"),e._uU(35,"Transferencia"),e.qZA(),e.TgZ(36,"ion-select-option"),e._uU(37,"Pesos"),e.qZA(),e.TgZ(38,"ion-select-option"),e._uU(39,"Dolares"),e.qZA()()(),e._UZ(40,"br")(41,"br")(42,"br"),e.TgZ(43,"ion-item")(44,"ion-label",6),e._UZ(45,"ion-icon",13),e._uU(46,".Buscar"),e.qZA(),e.TgZ(47,"ion-input",14),e.NdJ("ngModelChange",function(a){return n.searchText=a})("input",function(a){return n.onSearchInput(a)}),e.qZA()(),e._UZ(48,"br")(49,"br"),e.TgZ(50,"ion-grid")(51,"ion-row"),e._UZ(52,"ion-col",15),e.TgZ(53,"ion-col",15)(54,"strong"),e._uU(55,"No"),e.qZA()(),e.TgZ(56,"ion-col",15)(57,"strong"),e._uU(58,"Documento"),e.qZA()(),e.TgZ(59,"ion-col",15)(60,"strong"),e._uU(61,"Recepci\xf2n"),e.qZA()(),e.TgZ(62,"ion-col",15)(63,"strong"),e._uU(64,"Vencimiento"),e.qZA()(),e.TgZ(65,"ion-col",15)(66,"strong"),e._uU(67,"Faltantes"),e.qZA()(),e.TgZ(68,"ion-col",15)(69,"strong"),e._uU(70,"Despacho"),e.qZA()(),e.TgZ(71,"ion-col",15)(72,"strong"),e._uU(73,"Status"),e.qZA()(),e.TgZ(74,"ion-col",15)(75,"strong"),e._uU(76,"Saldo"),e.qZA()(),e.TgZ(77,"ion-col",15)(78,"strong"),e._uU(79,"Acciones"),e.qZA()()(),e.YNc(80,q,21,13,"ion-row",16),e.qZA(),e._UZ(81,"br")(82,"br")(83,"br"),e.TgZ(84,"ion-grid")(85,"ion-row"),e._UZ(86,"ion-col",17),e.TgZ(87,"ion-col",17)(88,"ion-item")(89,"ion-label",6),e._uU(90,"Recibo"),e.qZA(),e._UZ(91,"ion-input",18),e.qZA()(),e._UZ(92,"ion-col",17)(93,"ion-col",17),e.TgZ(94,"ion-col",17)(95,"ion-label"),e._uU(96,"Fecha"),e.qZA(),e.TgZ(97,"ion-button",19),e.NdJ("click",function(){return n.toggleCalendar()}),e._UZ(98,"ion-icon",20),e.qZA(),e.YNc(99,x,2,1,"div",21),e._UZ(100,"br"),e.TgZ(101,"div",22),e._uU(102),e.qZA()(),e.YNc(103,M,17,0,"ion-col",23),e._UZ(104,"ion-col",17),e.YNc(105,F,5,0,"ion-col",23),e._UZ(106,"ion-col",17),e.TgZ(107,"ion-col",17)(108,"ion-item")(109,"ion-label",6),e._uU(110,"Total"),e.qZA(),e._UZ(111,"ion-input",24),e.qZA()()()(),e._UZ(112,"br")(113,"br")(114,"br")(115,"br"),e.TgZ(116,"ion-row")(117,"ion-col")(118,"ion-button",25),e.NdJ("click",function(){return n.openGallery1()}),e._UZ(119,"ion-icon",26),e._uU(120," Seleccionar Recibo "),e.qZA(),e.YNc(121,w,3,0,"div",27),e.YNc(122,J,2,1,"div",16),e.qZA()(),e._UZ(123,"br")(124,"br"),e.TgZ(125,"ion-select",28),e.NdJ("ngModelChange",function(a){return n.itemsPerPage=a})("ionChange",function(a){return n.onPageChange(a)}),e.YNc(126,D,2,2,"ion-select-option",29),e.qZA(),e.TgZ(127,"ion-buttons")(128,"ion-button",30),e.NdJ("click",function(){return n.goToPage(n.currentPage-1)}),e._uU(129,"Anterior"),e.qZA(),e.TgZ(130,"ion-button",30),e.NdJ("click",function(){return n.goToPage(n.currentPage+1)}),e._uU(131,"Siguiente"),e.qZA()(),e._UZ(132,"br")(133,"br")(134,"br"),e.TgZ(135,"ion-button",31),e.NdJ("click",function(){return n.sendData()}),e._uU(136,"Reportar Pago"),e.qZA(),e._UZ(137,"br"),e.TgZ(138,"ion-button",32),e.NdJ("click",function(){return n.end()}),e._uU(139,"Salir"),e.qZA()()),2&o&&(e.Q6J("translucent",!0),e.xp6(4),e.Q6J("fullscreen",!0),e.xp6(12),e.Q6J("formGroup",n.FormInvoice),e.xp6(17),e.Q6J("ngModel",n.metodoPago),e.xp6(14),e.Q6J("ngModel",n.searchText),e.xp6(33),e.Q6J("ngForOf",n.displayedItems),e.xp6(11),e.Q6J("value",n.codmov),e.xp6(8),e.Q6J("ngIf",n.showCalendar),e.xp6(3),e.Oqu(n.currentDate),e.xp6(1),e.Q6J("ngIf","Transferencia"===n.metodoPago),e.xp6(2),e.Q6J("ngIf","Transferencia"===n.metodoPago||"Pesos"===n.metodoPago),e.xp6(6),e.Q6J("value",n.calcularTotal()),e.xp6(10),e.Q6J("ngIf",0===n.selectedImages1.length),e.xp6(1),e.Q6J("ngForOf",n.selectedImages1),e.xp6(3),e.Q6J("ngModel",n.itemsPerPage),e.xp6(1),e.Q6J("ngForOf",n.itemsPerPageOptions),e.xp6(2),e.Q6J("disabled",1===n.currentPage),e.xp6(2),e.Q6J("disabled",n.currentPage===n.totalPages))},dependencies:[h.sg,h.O5,g._Y,g.JJ,g.JL,g.On,l.YG,l.Sm,l.nz,l.wI,l.W2,l.x4,l.jY,l.Gu,l.gu,l.pK,l.Ie,l.Q$,l.Nd,l.t9,l.n0,l.wd,l.sr,l.w,l.as,l.QI,l.j9,g.sg,g.u,h.uU],styles:['@charset "UTF-8";.calendar-container[_ngcontent-%COMP%]{position:relative;display:inline-block}.custom-calendar[_ngcontent-%COMP%]{width:300px;max-height:300px;position:absolute;z-index:1;top:100%}']}),s})()}];let Q=(()=>{var i;class s{}return(i=s).\u0275fac=function(o){return new(o||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[v.Bz.forChild(N),v.Bz]}),s})(),Y=(()=>{var i;class s{}return(i=s).\u0275fac=function(o){return new(o||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[h.ez,g.u5,l.Pc,Q,g.UX]}),s})()}}]);